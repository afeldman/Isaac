<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>TimeLine of FANUC Robot Alarm History</title>
    
    <link rel="stylesheet" type="text/css" href="../node_modules/vis/dist/vis.min.css">
    <link href="./css/isaac.css" rel="stylesheet" type="text/css" />
    
    <script type="text/javascript" src="../node_modules/vis/dist/vis.min.js"></script>
    <script type="text/javascript" src="./js/vis_coloring.js"></script>    
    <script type="text/javascript">
      
      var data  = null;
      
      var $ = require("jquery");
      let parser = require('./js/parser/parser');
      let remote = require('electron').remote; 
      let dialog = remote.dialog;
      let fs = require('fs');
      
      function createTimeLine(filename){
	  var par = new parser(filename);
	  var items = new vis.DataSet(setcolor(par.getDataSet()));
	  
	  $("#visualization").html("");
	  
	  var container = document.getElementById('visualization');		      
	  var options = {height: "500px",
			 editable: true};
	  
	  // Create the timeline!
	  var timeline = new vis.Timeline(container, items, options);
	  	  
	  timeline.on('doubleClick', function(properties){
	      console.log(properties);
	  });
	  
	  items.on('*', function (event, properties) {
	      console.log('event=' + JSON.stringify(event) + ', ' +
			  'properties=' + JSON.stringify(properties));
	  });
	  
      }
      
      function openFileDialog(){
	  
	  document.getElementById('select-file').addEventListener('click', function(){
	      
	      dialog.showOpenDialog(function (fileNames) {
		  if(fileNames === undefined){
		      console.log("No file selected");
		  }else{
		      createTimeLine(fileNames[0]);
		  }
	      }); 
	  },false);
      }
      
    </script>
  </head>
  <body>
    
    <table style="width: 100%;">
      <tr style="width: 100%;">
	<td style="width: 100%;">
	  <div id="visualization"></div>
	</td>
      </tr>
    </table>
    
    <div style="text-align:center;">
      <input type="button" value="Open File" id="select-file" onClick="openFileDialog();"/>
    </div> 
    
  </body>
</html>
